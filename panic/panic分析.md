## panic源码解读

### panic的作用

- `panic`能够改变程序的控制流，调用`panic`后会立刻停止执行当前函数的剩余代码，并在当前`Goroutine`中递归执行调用方的`defer`；  

- `recover`可以中止`panic`造成的程序崩溃。它是一个只能在`defer`中发挥作用的函数，在其他作用域中调用不会发挥作用；  


#### error和panic

- error：可预见的错误

- panic：不可预见的异常

需要注意的是，你应该尽可能地使用`error`，而不是使用`panic`和`recover`。只有当程序不能继续运行的时候，才应该使用`panic`和`recover`机制。    

`panic`有两个合理的用例。  

1、发生了一个不能恢复的错误，此时程序不能继续运行。 一个例子就是 web 服务器无法绑定所要求的端口。在这种情况下，就应该使用 panic，因为如果不能绑定端口，啥也做不了。  

2、发生了一个编程上的错误。 假如我们有一个接收指针参数的方法，而其他人使用 nil 作为参数调用了它。在这种情况下，我们可以使用panic，因为这是一个编程错误：用 nil 参数调用了一个只能接收合法指针的方法。  

在一般情况下，我们不应通过调用panic函数来报告普通的错误，而应该只把它作为报告致命错误的一种方式。当某些不应该发生的场景发生时，我们就应该调用panic。  

总结下`panic`的使用场景:  

- 1、空指针引用

- 2、下标越界

- 3、除数为0

- 4、不应该出现的分支，比如default

- 5、输入不应该引起函数错误  