<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

- [网络学习](#%E7%BD%91%E7%BB%9C%E5%AD%A6%E4%B9%A0)
  - [一些基础的知识点学习](#%E4%B8%80%E4%BA%9B%E5%9F%BA%E7%A1%80%E7%9A%84%E7%9F%A5%E8%AF%86%E7%82%B9%E5%AD%A6%E4%B9%A0)
  - [IP](#ip)
    - [分类 IP 地址](#%E5%88%86%E7%B1%BB-ip-%E5%9C%B0%E5%9D%80)
  - [划分子网](#%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91)
    - [1、节省 IP 地址资源，提高 IP 地址的利用率；](#1%E8%8A%82%E7%9C%81-ip-%E5%9C%B0%E5%9D%80%E8%B5%84%E6%BA%90%E6%8F%90%E9%AB%98-ip-%E5%9C%B0%E5%9D%80%E7%9A%84%E5%88%A9%E7%94%A8%E7%8E%87)
    - [2、给每一个物理网络分配一个网络号会使得路由表变得太大因为网络性能变差](#2%E7%BB%99%E6%AF%8F%E4%B8%80%E4%B8%AA%E7%89%A9%E7%90%86%E7%BD%91%E7%BB%9C%E5%88%86%E9%85%8D%E4%B8%80%E4%B8%AA%E7%BD%91%E7%BB%9C%E5%8F%B7%E4%BC%9A%E4%BD%BF%E5%BE%97%E8%B7%AF%E7%94%B1%E8%A1%A8%E5%8F%98%E5%BE%97%E5%A4%AA%E5%A4%A7%E5%9B%A0%E4%B8%BA%E7%BD%91%E7%BB%9C%E6%80%A7%E8%83%BD%E5%8F%98%E5%B7%AE)
    - [3、减少广播所带来的负面影响](#3%E5%87%8F%E5%B0%91%E5%B9%BF%E6%92%AD%E6%89%80%E5%B8%A6%E6%9D%A5%E7%9A%84%E8%B4%9F%E9%9D%A2%E5%BD%B1%E5%93%8D)
  - [子网掩码](#%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81)
    - [1、声明网络地址与主机地址](#1%E5%A3%B0%E6%98%8E%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E4%B8%8E%E4%B8%BB%E6%9C%BA%E5%9C%B0%E5%9D%80)
    - [2、划分子网](#2%E5%88%92%E5%88%86%E5%AD%90%E7%BD%91)
  - [无类型域间选路（CIDR）](#%E6%97%A0%E7%B1%BB%E5%9E%8B%E5%9F%9F%E9%97%B4%E9%80%89%E8%B7%AFcidr)
  - [广播地址](#%E5%B9%BF%E6%92%AD%E5%9C%B0%E5%9D%80)
  - [公有IP和私有IP](#%E5%85%AC%E6%9C%89ip%E5%92%8C%E7%A7%81%E6%9C%89ip)
  - [MAC地址](#mac%E5%9C%B0%E5%9D%80)
  - [网络设备标识](#%E7%BD%91%E7%BB%9C%E8%AE%BE%E5%A4%87%E6%A0%87%E8%AF%86)
  - [参考](#%E5%8F%82%E8%80%83)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

## 网络学习

### 一些基础的知识点学习  

```shell
root@test:~# ip addr
1: lo: <LOOPBACK,UP,LOWER_UP> mtu 65536 qdisc noqueue state UNKNOWN group default 
    link/loopback 00:00:00:00:00:00 brd 00:00:00:00:00:00
    inet 127.0.0.1/8 scope host lo
       valid_lft forever preferred_lft forever
    inet6 ::1/128 scope host 
       valid_lft forever preferred_lft forever
2: eth0: <BROADCAST,MULTICAST,UP,LOWER_UP> mtu 1500 qdisc pfifo_fast state UP group default qlen 1000
    link/ether fa:16:3e:c7:79:75 brd ff:ff:ff:ff:ff:ff
    inet 10.100.122.2/24 brd 10.100.122.255 scope global eth0
       valid_lft forever preferred_lft forever
    inet6 fe80::f816:3eff:fec7:7975/64 scope link 
       valid_lft forever preferred_lft forever
```

### IP

IP 地址就是一个网卡在网络世界的通讯地址，相当于我们现实世界的门牌号码。  

IP 地址是一个唯一的 32 位标识符。  

IP 地址最基本的编址方法就是：**分类 IP 地址**编址。     

#### 分类 IP 地址

分类 IP 地址：就是将 IP 地址划分成若干个分类，每一类地址都有两个固定长度的字段组成。  

第一个字段是网络号：标志着主机（或路由器）所连接的网络，一个网络号在整个互联网中是唯一的。  

第二个字段是主机号：主机号用于识别该网络中的主机。一台主机号在它前面的网络号做指定的网络的范围内必须是唯一的。   

所以网络号的唯一，加上主机号在网络号中的唯一，可以得出 IP 地址在整个互联网内是唯一的。  

`IP 地址：={<网络号>，<主机号>}`     

分类 IP 地址在设计的过程中，前面一部分是网络号，后面一部分是主机号。    

<img src="/img/ip/ip-class.jpg"  alt="tcp" />   

对于主机和路由器来来说，IP 地址都是 32 位的二进制代码，但是这样可读性不好，所以引入了**点分十进制记法**。  

点分十进制记法：为了提高可读性，尝尝把 32 位的 IP 地址中每 8 位插入一个空格（机器中是没有这样的空格）。同时用等效的十进制数字表示，同时加入一个点。  

<img src="/img/ip/ip-class-1.jpg"  alt="tcp" />   

知道了如何分类，我们就能算出 IP 地址的指派范围  

<img src="/img/ip/ip-class-2.jpg"  alt="tcp" />     

### 划分子网

为什么需要划分子网，划分子网的作用和意义？  

#### 1、节省 IP 地址资源，提高 IP 地址的利用率；  

划分子网之后，其实是减少了能连接在网络中的主机数，但是却说提高了 IP 地址的利用率，可能有点歧义，这里举个栗子，来分析下    

加入某个学校有四个机房，每个机房30台机器，如果不划分子网，那就很简单，申请 4 个 C 类地址，一个个机房配置下就行了，这样做就造成一部分 IP 的浪费。  

我们知道 C 类地址的最大主机数是254，那么这样使用下来，每个机房只用到了30个IP,一共造成了 4*(256-30) 个 IP 的浪费。如果大家都这样操作的话，那么 Internet 上的 IP 地址早就枯竭了。     

划分子网之后   

只需要申请一个 C 类地址，然后划分成 4 个子网，这样可以满足需求了  

#### 2、给每一个物理网络分配一个网络号会使得路由表变得太大因为网络性能变差  

每一个路由器都应当能够从路由表中查出应怎样到达其它网络的下一跳路由器，因此互联网中的网络数越多，路由器路由表中的项目数也就越多，这样会使整个路由器和互联网的性能下降。  

#### 3、减少广播所带来的负面影响

减少广播所带来的负面影响，提高性能的整体性能。因为广播数据包只能在同一网段中传输，通过划分子网，网络规模小了，网络中用户数少了，当然所占用的资源也就少了。

### 子网掩码

子网掩码是一个32位地址，是与IP地址结合使用的一种技术。它的主要作用有两个，一是用于屏蔽IP地址的一部分以区别网络标识和主机标识，并说明该IP地址是在局域网上，还是在远程网上。二是用于将一个大的IP网络划分为若干小的子网络。

#### 1、声明网络地址与主机地址

子网掩码是一个32位地址：

对于A类地址来说，默认的子网掩码是 `255.0.0.0`；

对于B类地址来说默认的子网掩码是 `255.255.0.0`；

对于C类地址来说默认的子网掩码是 `255.255.255.0`。  

将32位的子网掩码与IP地址进行二进制形式的按位逻辑“与”运算得到的便是网络地址；   

将子网掩码二进制的非的结果和IP地址二进制进行逻辑“与”（AND）运算，得到的就是主机地址。   

子网掩码的规则：

用户连续的1对应网络号和子网号；

用连续的0对应主机号，得到32位的二进制；

#### 2、划分子网

上面我们讨论了划分子网的意义，子网掩码就可以帮助我们对子网进行划分。  

其作用是：减少网络上的通信量；节省IP地址；便于管理；解决物理网络本身的某些问题。使用子网掩码划分子网后，子网内可以通信，跨子网不能通信，子网间通信应该使用路由器，并正确配置静态路由信息。

子网划分结构的规则。就是用连续的1在IP地址中增加表示网络地址，同时减少表示主机地址的位数。  

### 无类型域间选路（CIDR）  

分类 IP 地址的划分还是有点不科学，比如 c 类地址，同一个网络下面只有 254 个主机，显然是有点少了，B 类地址中，同一个网络中可以放65534台主机，这显然有点多了，一般企业达不到这样的规模。  

可以不可以按需分配IP地址呢，需要多少个就分配多少个。   

所以有了一个折中的方式叫作无类型域间选路，简称 CIDR。   

无类型域间选路（CIDR）打破了原来设计中的几类地址的做法，将 32 位的 IP 地址一分为二，**前面是网络号，后面是主机号**。    

<img src="/img/ip/ip-classs-5.jpg"  alt="tcp" />   

栗如：`10.100.122.2/24`   

这个 IP 地址中有一个斜杠，斜杠后面有个数字 24。这种地址表示形式，就是 CIDR。后面 24 的意思是，32 位中，前 24 位是网络号，后 8 位是主机号。    

CIDR 的优点：  

1、使用变长的"网络前缀"(network-prefix)来替代分类中的网络号和主机号，IP 地址从三级编址(使用子网掩码)又回到了两级编制。     

2、可以将网络前缀相同的连续IP地址组成"CIDR地址块"，一个"CIDR地址块"可以表示很多地址，这种地址的聚合成为路由聚合，也称为构成超网。在互联网中，只要有可能，就显示为一个聚合的网络，路由聚合减少了路由器之间的路由选择信息交换，提高了整个互联网的性能；   

3、可以更加有效的分配IPv4地址空间，通过分配适大小的CIDR地址块，按需分配IP地址呢，需要多少个就分配多少个。  

### 广播地址

广播地址(Broadcast Address)是专门用于同时向网络中所有工作站进行发送的一个地址。  

在使用TCP/IP 协议的网络中，主机标识段为全1 的 IP 地址为广播地址，广播的分组传送给段所涉及的所有计算机。

栗如：  

对于10.1.1.0 （255.255.255.0 ）网段，其广播地址为10.1.1.255 （255 即为2 进制的11111111 ），当发出一个目的地址为10.1.1.255 的分组（封包）时，它将被分发给该网段上的所有计算机。

### 公有IP和私有IP

组建一个企业级网络，需要去向“电信运营商 ISP ”申请一个接入 Internet 的宽带，同时 ISP 还会给我们分配一个或多个 IP 地址，这些IP地址可以供我们企业内部上网，这些 ISP 分配给我们的 IP，就是公有 IP。  

公有地址（`Public address`，也可称为公网地址）由`Internet NIC`（`Internet Network Information Center`因特网信息中心）负责。这些IP地址分配给注册并向`Internet NIC`提出申请的组织机构。通过它直接访问因特网，它是广域网范畴内的。  

我们企业或家庭内部组建局域网用的IP，一般都会用私有IP。  

私有地址（`Private address`，也可称为专网地址）属于非注册地址，专门为组织机构内部使用，它是局域网范畴内的，私有IP禁止出现在 Internet 中，在 ISP 连接用户的地方，将来自于私有 IP 的流量全部都会阻止并丢掉。      

<img src="/img/ip/ip-class-4.jpg"  alt="tcp" />

### MAC地址 

MAC地址：（英语：Media Access Control Address），直译为媒体访问控制地址，也称为局域网地址（LAN Address），以太网地址（Ethernet Address）或物理地址（Physical Address），它是一个用来确认网络设备位置的地址。    

MAC地址是全局唯一的，不会有两个相同的网卡有相同的 MAC 地址，MAC 地址都是由生产厂家在生产时固化在网络硬件中，是硬件预留的地址。   

MAC地址更像是身份证，是一个唯一的标识。它的唯一性设计是为了组网的时候，不同的网卡放在一个网络里面的时候，可以不用担心冲突。从硬件角度，保证不同的网卡有不同的标识。  

MAC地址的通讯，只限于同一个子网中，如果跨子网就不能通信了。

### 网络设备标识

<BROADCAST,MULTICAST,UP,LOWER_UP>这个叫作`net_device flags`，网络设备的状态标识。    

UP表示网卡处于启动的状态；  

`BROADCAST`表示这个网卡有广播地址，可以发送广播包；  

`MULTICAST`表示网卡可以发送多播包；  

`LOWER_UP`表示L1是启动的，也即网线插着呢。  

`MTU1500`是指什么意思呢？是哪一层的概念呢？最大传输单元MTU为1500，这是以太网的默认值。

### 参考

【极客时间-趣谈网络协议】https://time.geekbang.org/column/intro/100007101  
【子网掩码是什么？有什么作用？】https://zhuanlan.zhihu.com/p/371400090    
【公有IP和私有IP介绍】https://blog.csdn.net/tanga842428/article/details/72851429  
【子网掩码】https://baike.baidu.com/item/%E5%AD%90%E7%BD%91%E6%8E%A9%E7%A0%81/100207  
【划分子网的意义】https://blog.csdn.net/tao546377318/article/details/50217729    


