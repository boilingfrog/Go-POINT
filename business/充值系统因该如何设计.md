## 如何做充值业务

### 前言

最近在整理公司的充值设计方案，发现了几个设计不是很合理的地方，秉着发现问题解决问题的原则，本次就整理下标准的充值系统整体应该如何设计。   

这里整理了几点充值中较为重要的点：  

1、保证事务性，订单和用户账户余额的修改要保持一致，要不都成功，要么都是失败；  

2、幂等性，保证每笔订单只会处理一次，不能出现，同一笔订单，用户余额增加两次的问题；  

3、时效性，充值我们一般借助于第三方平台，微信或者支付宝，一般充值成功之后，我们会收到充值成功的回调，但是在某些异常的情况，如果没有及时收到回调，我们也要保证充值的时效性；  

### 