<!-- START doctoc generated TOC please keep comment here to allow auto update -->
<!-- DON'T EDIT THIS SECTION, INSTEAD RE-RUN doctoc TO UPDATE -->

- [如何做充值业务](#%E5%A6%82%E4%BD%95%E5%81%9A%E5%85%85%E5%80%BC%E4%B8%9A%E5%8A%A1)
  - [前言](#%E5%89%8D%E8%A8%80)
  - [方案设计](#%E6%96%B9%E6%A1%88%E8%AE%BE%E8%AE%A1)

<!-- END doctoc generated TOC please keep comment here to allow auto update -->

## 如何做充值业务

### 前言

最近在整理公司的充值设计方案，发现了几个设计不是很合理的地方，秉着发现问题解决问题的原则，本次就整理下标准的充值系统整体应该如何设计。   

这里整理了几点充值中较为重要的点：  

1、保证事务性，订单和用户账户余额的修改要保持一致，要不都成功，要么都是失败；  

2、幂等性，保证每笔订单只会处理一次，不能出现，同一笔订单，用户余额增加两次的问题；  

3、时效性，充值我们一般借助于第三方平台，微信或者支付宝，一般充值成功之后，我们会收到充值成功的回调，但是在某些异常的情况，如果没有及时收到回调，我们也要保证充值的时效性；  

### 方案设计


### 参考

